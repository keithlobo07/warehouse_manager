# Warehouse Manager

This repository contains a comprehensive Warehouse Management System that combines a traditional database-driven inventory system with an advanced AI-powered pathfinding module for robot navigation. The system uses a SQLite database to manage products, suppliers, and stock levels, and leverages both A* search and a Deep Q-Network (DQN) for optimizing robot movement within a grid-based warehouse layout.

## Features

*   **Database Management**: A robust SQLite database schema to manage suppliers, products, stock, and transactions. Includes functions for creating, resetting, and populating tables with initial data.
*   **Warehouse Layout Customization**: Define the warehouse layout (shelves and paths) using a simple text file (`layout.txt`).
*   **A* Pathfinding**: An implementation of the A* search algorithm to find the optimal path between two points in the warehouse, accounting for obstacles.
*   **AI-Powered Navigation**:
    *   A Deep Q-Network (DQN) model built with PyTorch for reinforcement learning-based pathfinding.
    *   A training script (`train.py`) to train the DQN agent to navigate the warehouse grid.
    *   An inference script (`inference.py`) to use the trained model for finding paths.
*   **Automated Dataset Generation**: A script (`dataSetGenerator.py`) that uses the A* algorithm to generate training and testing datasets for machine learning models.
*   **Modular Design**: The project is broken down into logical modules for database functions, grid setup, search algorithms, and the DQN model.

## Repository Structure

```
.
├── initialise.py            # Script to initialize and populate the database. RUN THIS FIRST.
├── db_func.py               # Core functions for all database interactions.
├── layout.txt               # Text file defining the warehouse grid (P=Path, S=Shelf).
├── warehouse.db             # The SQLite database file (generated by initialise.py).
│
├── search.py                # Implementation of the A* search algorithm.
├── setGrid.py               # Functions to generate the grid from the database layout.
│
├── dqn_model.py             # Defines the PyTorch DQN Network, Agent, and Environment classes.
├── train.py                 # Script to train the DQN model.
├── inference.py             # Script to run inference using a trained DQN model.
├── grid_data.json           # JSON configuration for the DQN training environment.
│
├── dataSetGenerator.py      # Generates training/test data using A* search.
├── training_data.csv        # Generated training data for pathfinding prediction.
├── test_data.csv            # Generated test data for pathfinding prediction.
│
└── robot.py                 # A simple data class representing a warehouse robot.
```

## Getting Started

### Prerequisites

You need to have Python 3 installed. You will also need to install the required Python packages.

```bash
pip install torch numpy tabulate
```

### Installation & Setup

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/keithlobo07/warehouse_manager.git
    cd warehouse_manager
    ```

2.  **Initialize the Database:**
    Run the `initialise.py` script. This will create the `warehouse.db` file, set up all the necessary tables, and populate them with sample data from `layout.txt` and hardcoded values.

    ```bash
    python initialise.py
    ```

## Usage

The project is divided into two main components: the database management system and the AI pathfinding module.

### Database Interaction

The `db_func.py` module contains all the functions needed to interact with the warehouse database. You can import and use these functions in your own scripts to add products, update stock, view tables, etc.

Example: To view the contents of the `products` table:

```python
from db_func import db_connect, view_tables, db_close

db_connect()
view_tables('products')
db_close()
```

### AI Pathfinding (DQN)

The system includes a Deep Q-Network to train an agent to navigate the warehouse.

#### 1. Configure the Environment

The `grid_data.json` file defines the simple grid, start position, and target for the DQN agent. You can modify this file to change the training task. By default, it uses a small 5x5 grid.

#### 2. Train the Agent

Run the `train.py` script to start the training process. The script will train the agent for 500 episodes and save the trained model weights to `models/pathfinder_trained.pth`.

```bash
python train.py
```
This will create a `models` directory and save the trained model inside it.

#### 3. Run Inference

Once the model is trained, you can use `inference.py` to see it in action. This script loads the trained model and uses it to find a path from the start to the target in the environment defined in `grid_data.json`.

```bash
python inference.py
```

The output will show the path found, the total reward, and a visualization of the path on the grid.

### A* Search

The A* search algorithm in `search.py` can be used independently for guaranteed optimal pathfinding on the main warehouse grid.

Example usage:

```python
from setGrid import generate_warehouse, get_warehouse_grid
from search import a_star_search

# Load warehouse grid from the database
shelf_coords, path_coords = get_warehouse_grid()
grid = generate_warehouse(63, 13, shelf_coords)

# Define start and goal coordinates
start_node = (0, 0)
goal_node = (50, 10) # An aisle coordinate

# Find the path
path, cost, expansions, run_time = a_star_search(grid, start_node, goal_node)

if path:
    print(f"Path found with cost {cost} in {run_time:.4f} seconds.")
    print(path)
else:
    print("No path found.")
