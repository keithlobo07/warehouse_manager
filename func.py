import sqlite3
from tabulate import tabulate

'''---Database Connection---'''

def db_connect():
    """
    Connect to the SQLite database (or create it if it doesn't exist).
    Returns the connection object.
    """
    
    global conn, cursor
    conn = sqlite3.connect('warehouse.db')
    cursor = conn.cursor()
    conn.commit()
    return conn

'''---Create Tables---'''

def create_tables():
    """_summarry_
    Create the necessary tables in the database if they do not already exist.
    1. suppliers\n
    supplierID - 3 digit unique supplier identifier (Primary Key)\n
    supplierName - Name of the supplier (Not Null)\n
    contactName - Name of the contact person at the supplier\n
    email - Email address of the contact person\n
    2. products\n
    productID - 6 digit unique product identifier (Primary Key) Format: XXXYYY (supplierID + unique product code)\n
    productName - Name of the product (Not Null, Unique)\n
    ean - 13 digit European Article Number (Not Null, Unique)\n
    price - Price of the product (Not Null)\n
    supplierID - 3 digit unique supplier identifier (Foreign Key referencing suppliers table)\n
    3. stock\n
    itemID - 10 digit unique stock item identifier (Primary Key) Format: XXXXXXZZZZ (productID + location)\n
    productID - 6 digit unique product identifier (Foreign Key referencing products table)\n
    location - Cartesian location code in the warehouse (Not Null, Unique) Format: xxyy where xx is the row and yy is the column\n
    quantity - Quantity of the product at the location (Not Null)\n
    expiry - Expiry date of the product (if applicable)\n
    warehouseID - Identifier for the warehouse (Foreign Key referencing warehouse table)\n
    4. transactions\n
    transactionID - 10 digit unique transaction identifier (Primary Key)\n
    productID - 6 digit unique product identifier (Foreign Key referencing products table)\n
    transactionDate - Date of the transaction (Not Null)\n
    quantityChange - Change in quantity (positive for IN, negative for OUT) (Not Null, Check constraint to ensure non-zero)\n
    transactionType - Type of transaction ('IN' or 'OUT') (Not Null, Check constraint)\n
    """
    
    cursor.execute('''
                    CREATE TABLE IF NOT EXISTS suppliers(
                    supplierID INTEGER(3) UNIQUE PRIMARY KEY,
                    supplierName TEXT NOT NULL,
                    contactName TEXT,
                    email TEXT
                    );
                    '''
                    )
    cursor.execute('''
                    CREATE TABLE IF NOT EXISTS products(
                    productID TEXT(6) UNIQUE PRIMARY KEY,
                    productName TEXT NOT NULL UNIQUE,
                    ean TEXT(13) NOT NULL UNIQUE,
                    price REAL NOT NULL,
                    supplierID INTEGER(3),
                    FOREIGN KEY (supplierID) REFERENCES suppliers(supplierID)
                    );
                    '''
                    )
    cursor.execute('''
                    CREATE TABLE IF NOT EXISTS stock(
                    itemID TEXT(10) AS (productID || location),
                    productID TEXT(6),
                    location TEXT(4) PRIMARY KEY,
                    quantity INTEGER NOT NULL,
                    expiry DATE,
                    warehouseID INTEGER,
                    FOREIGN KEY (productID) REFERENCES products(productID),
                    FOREIGN KEY (warehouseID) REFERENCES warehouse(warehouseID)
                    );
                    '''
                    )
    cursor.execute('''
                    CREATE TABLE IF NOT EXISTS transactions(
                    transactionID INTEGER(10) PRIMARY KEY,
                    productID TEXT(6) NOT NULL,
                    location TEXT(4) NOT NULL,
                    transactionDate DATE NOT NULL,
                    quantityChange INTEGER NOT NULL CHECK (quantityChange != 0),
                    transactionType TEXT NOT NULL CHECK (transactionType IN ('IN', 'OUT')),
                    FOREIGN KEY (productID) REFERENCES products(productID)
                    );
                    '''
                    )
    conn.commit()
  
'''---Initialise Tables---'''
def init_suppliers():
    """
    Initialize the suppliers table with example data.
    """
    suppliers=[
            (101, 'Tesco', 'Ludovic Magerand', 'l.magerand@dundee.ac.uk'),
            (102, 'Currys', 'Femi Samuel', 'osamuel002@dundee.ac.uk'),
            (103, 'Lidl', 'John Lawrence', 'j.lawrence@dundee.ac.uk'),
            (104, 'Ikea', 'Craig Ramsay', 'c.d.ramsay@dundee.ac.uk')
            ]
    cursor.executemany('INSERT OR IGNORE INTO suppliers (supplierID, supplierName, contactName, email) VALUES (?, ?, ?, ?);', suppliers)
    conn.commit()

def init_products():
    """
    Initialize the products table with example data.
    """
    products=[
            # 101 - Tesco
            ('101001', 'Frosted Flakes 500g', '5000119123831', 0.95, 101),
            ('101002', 'Digestive Biscuits 400g', '5059739501064', 0.60, 101),
            ('101003', 'Free Range Eggs (12-pack)', '5057753178044', 3.50, 101),
            ('101004', 'White Bread (Medium)', '5059690184090', 1.00, 101),
            ('101005', 'Bananas (Bunch of 5)', '0266419328006', 0.99, 101),
            ('101006', 'Frozen Peas 1kg', '5054778129701', 1.50, 101),
            ('101007', 'Orange Juice (Smooth)', '5059739501538', 2.00, 101),
            ('101008', 'Kitchen Towels (4-pack)', '5059690199018', 4.50, 101),
            ('101009', 'Cat Food (Tuna)', '5059690188763', 0.65, 101),
            ('101010', 'Frozen Chips 900g', '5059690177789', 2.20, 101),
            ('101011', 'Salmon Fillets (2-pack)', '5059690199049', 5.50, 101),
            ('101012', 'Salted Butter 250g', '5059690180214', 1.80, 101),
            ('101013', 'Premium Toilet Rolls (9-pack)', '5059690177703', 7.95, 101),
            ('101014', 'Canned Diced Tomatoes', '5059690165008', 0.55, 101),
            ('101015', 'Olive Oil (Extra Virgin) 1L', '5059690154031', 6.50, 101),
            ('101016', 'Basmati Rice 1kg', '5059690143899', 3.00, 101),
            ('101017', 'Washing Up Liquid', '5059690132101', 1.20, 101),
            ('101018', 'Chicken Breast (4-pack)', '5059690129810', 4.90, 101),
            ('101019', 'Block Cheddar Cheese 350g', '5059690111195', 3.10, 101),
            ('101020', 'Black Pepper Grinder', '5059690100100', 1.75, 101),
            ('101021', 'A-Batteries (4-pack)', '5059690100099', 2.50, 101),
            ('101022', 'Frozen Pizza (Margherita)', '5059690190010', 2.50, 101),
            ('101023', 'Crisp Multi-Pack (Salt & Vinegar)', '5059690185001', 3.20, 101),
            ('101024', 'Instant Coffee Jar 100g', '5059690177002', 2.80, 101),
            ('101025', 'Chocolate Bar (Milk)', '5059690166011', 0.80, 101),
            ('101026', 'Sparkling Water 6x1L', '5059690150033', 3.99, 101),
            ('101027', 'Red Grapes 500g', '5059690140088', 2.40, 101),
            ('101028', 'Tuna Chunks in Brine (4-pack)', '5059690130001', 3.80, 101),
            
            # 102 - Currys
            ('102001', 'APPLE MacBook Air', '0195949837913', 948.99, 102),
            ('102002', 'SAMSUNG Galaxy S25 256GB', '8806095852072', 858.99, 102),
            ('102003', 'GOOGLE Pixel 10 Pro XL 256GB', '0840353927742', 999.00, 102),
            ('102004', 'SONY Bravia 55" OLED TV', '4548736122692', 1299.00, 102),
            ('102005', 'Bose QuietComfort Earbuds II', '017817844053', 259.99, 102),
            ('102006', 'Logitech Wireless Mouse', '5099206095209', 15.99, 102),
            ('102007', 'SanDisk 1TB Portable SSD', '619659178330', 99.99, 102),
            ('102008', 'HP DeskJet Printer', '0889899385579', 49.99, 102),
            ('102009', 'Amazon Echo Dot (5th Gen)', '0840080536783', 34.99, 102),
            ('102010', 'Nintendo Switch Lite Console', '0045496453472', 199.00, 102),
            ('102011', 'Power Extension Cable (4-way)', '5055819747209', 12.50, 102),
            ('102012', 'Samsung 32" Curved Monitor', '8806094595854', 289.00, 102),
            ('102013', 'External Web Camera (1080p)', '607421008035', 29.99, 102),
            
            # 103 - Lidl
            ('103001', 'Scottish Whole Milk 4 pint', '4056489755562', 1.65, 103),
            ('103002', 'Deluxe Italian Prosciutto', '4002422005877', 3.20, 103),
            ('103003', 'Fairtrade Ground Coffee 500g', '4056489110012', 4.50, 103),
            ('103004', 'Organic Red Wine (Merlot)', '4056489991234', 6.99, 103),
            ('103005', 'Artisan Sourdough Loaf', '4056489880055', 2.10, 103),
            ('103006', 'Premium Dark Chocolate 70%', '4056489777123', 1.89, 103),
            ('103007', 'Fresh Basil Plant', '4056489660991', 1.50, 103),
            ('103008', 'Greek Style Yogurt 500g', '4056489555002', 1.10, 103),
            ('103009', 'Frozen Seafood Mix 750g', '4056489440011', 5.99, 103),
            ('103010', 'Premium Lager 6-Pack', '4056489333003', 7.50, 103),
            ('103011', 'Pistachio Ice Cream 500ml', '4056489222112', 3.99, 103),
            ('103012', 'Large Avocados (2-pack)', '4056489111001', 2.99, 103),
            ('103013', 'Premium Balsamic Vinegar', '4056489000555', 4.20, 103),
            ('103014', 'Feta Cheese Block 200g', '4056489000123', 2.30, 103),
                    
            # 104 - Ikea
            ('104001', 'Insulated Travel Mug', '2051357019955', 8.00, 104),
            ('104002', 'Bag (Medium)', '0720189711077', 0.50, 104),
            ('104003', 'Side Table (Black)', '0880001298916', 10.00, 104),
            ('104003', 'Side Table (Black)', '0880001298916', 10.00, 104),
            ('104004', 'Desk Lamp (White)', '0032543209876', 15.00, 104),
            ('104005', 'Set of 4 Dining Chairs (Grey)', '5042543219800', 99.00, 104),
            ('104006', 'Small Plant Pot', '1011122334455', 3.00, 104),
            ('104007', 'Billy Bookcase (Oak)', '6010001000701', 45.00, 104),
            ('104008', 'Dinner Plate Set (4-pack)', '4009876543210', 14.99, 104),
            ('104009', 'Set of 3 Food Containers', '3034567890123', 5.50, 104),
            ('104010', 'Large Woven Storage Basket', '2023456789012', 12.00, 104),
            ('104011', 'Candle Holder (Silver)', '1012345678901', 3.50, 104),
            ('104012', 'Queen Sized Duvet Cover', '0000000111223', 25.00, 104),
            ('104013', 'Picture Frame (A4)', '0000000222334', 4.00, 104),
            ('104014', 'Small Flat-Pack Drawer Unit', '0000000333445', 29.00, 104),
            ('104015', 'Rug (Small, Grey)', '0000000444556', 19.99, 104),
            
            ]
    cursor.executemany('INSERT OR IGNORE INTO products (productID, productName, ean, price, supplierID) VALUES (?, ?, ?, ?, ?);', products)
    conn.commit()

def init_stock():
    """
    Initialize the stock table with example data.
    """
    stock=[
            [# 101 - Tesco
            # Row 01
            ('101001', '0101', 150, '2026-06-30', 6),
            ('101002', '0103', 200, '2026-08-01', 6),
            ('101003', '0105', 30, '2026-01-15', 6),
            ('101004', '0107', 100, '2026-01-25', 6),
            ('101005', '0109', 50, '2026-01-20', 6),
            ('101006', '0111', 120, '2026-10-30', 6),
            ('101007', '0113', 80, '2026-06-30', 6),
            ('101008', '0115', 60, None, 6),
            ('101009', '0117', 180, '2026-09-01', 6),
            ('101010', '0119', 110, '2026-10-30', 6),
            ('101011', '0121', 25, '2026-02-10', 6),
            ('101012', '0123', 75, '2026-02-15', 6),
            ('101013', '0125', 40, '2026-06-30', 6),
            ('101014', '0127', 250, '2027-01-01', 6),
            ('101015', '0129', 30, '2028-01-01', 6),
            ('101016', '0131', 150, '2027-06-30', 6),
            ('101017', '0133', 80, None, 6),
            ('101018', '0135', 40, '2026-01-20', 6),
            ('101019', '0137', 50, '2026-03-01', 6),
            ('101020', '0139', 100, '2027-06-30', 6),
            ('101021', '0141', 90, '2028-01-01', 6),
            ('101022', '0143', 70, '2026-10-30', 6),
            ('101023', '0145', 100, '2026-06-30', 6),
            ('101024', '0147', 80, '2027-01-01', 6),
            ('101025', '0149', 250, '2026-08-01', 6),
            ('101026', '0151', 90, '2027-01-01', 6),
            ('101027', '0153', 45, '2026-01-18', 6),
            ('101028', '0155', 80, '2027-01-01', 6),
            ('101001', '0157', 150, '2026-06-30', 6),
            ('101002', '0159', 200, '2026-08-01', 6),
            ('101003', '0161', 30, '2026-01-15', 6),
            
            # Row 02
            ('101004', '0201', 100, '2026-01-25', 6),
            ('101005', '0203', 50, '2026-01-20', 6),
            ('101006', '0205', 120, '2026-10-30', 6),
            ('101007', '0207', 80, '2026-06-30', 6),
            ('101008', '0209', 60, None, 6),
            ('101009', '0211', 180, '2026-09-01', 6),
            ('101010', '0213', 110, '2026-10-30', 6),
            ('101011', '0215', 25, '2026-02-10', 6),
            ('101012', '0217', 75, '2026-02-15', 6),
            ('101013', '0219', 40, '2026-06-30', 6),
            ('101014', '0221', 250, '2027-01-01', 6),
            ('101015', '0223', 30, '2028-01-01', 6),
            ('101016', '0225', 150, '2027-06-30', 6),
            ('101017', '0227', 80, None, 6),
            ('101018', '0229', 40, '2026-01-20', 6),
            ('101019', '0231', 50, '2026-03-01', 6),
            ('101020', '0233', 100, '2027-06-30', 6),
            ('101021', '0235', 90, '2028-01-01', 6),
            ('101022', '0237', 70, '2026-10-30', 6),
            ('101023', '0239', 100, '2026-06-30', 6),
            ('101024', '0241', 80, '2027-01-01', 6),
            ('101025', '0243', 250, '2026-08-01', 6),
            ('101026', '0245', 90, '2027-01-01', 6),
            ('101027', '0247', 45, '2026-01-18', 6),
            ('101028', '0249', 80, '2027-01-01', 6),
            ('101001', '0251', 150, '2026-06-30', 6),
            ('101002', '0253', 200, '2026-08-01', 6),
            ('101003', '0255', 30, '2026-01-15', 6),
            ('101004', '0257', 100, '2026-01-25', 6),
            ('101005', '0259', 50, '2026-01-20', 6),
            ('101006', '0261', 120, '2026-10-30', 6),
            # Row 03
            ('101007', '0301', 80, '2026-06-30', 6),
            ('101008', '0303', 60, None, 6),
            ('101009', '0305', 180, '2026-09-01', 6),
            ('101010', '0307', 110, '2026-10-30', 6),
            ('101011', '0309', 25, '2026-02-10', 6),
            ('101012', '0311', 75, '2026-02-15', 6),
            ('101013', '0313', 40, '2026-06-30', 6),
            ('101014', '0315', 250, '2027-01-01', 6),
            ('101015', '0317', 30, '2028-01-01', 6),
            ('101016', '0319', 150, '2027-06-30', 6),
            ('101017', '0321', 80, None, 6),
            ('101018', '0323', 40, '2026-01-20', 6),
            ('101019', '0325', 50, '2026-03-01', 6),
            ('101020', '0327', 100, '2027-06-30', 6),
            ('101021', '0329', 90, '2028-01-01', 6),
            ('101022', '0331', 70, '2026-10-30', 6),
            ('101023', '0333', 100, '2026-06-30', 6),
            ('101024', '0335', 80, '2027-01-01', 6),
            ('101025', '0337', 250, '2026-08-01', 6),
            ('101026', '0339', 90, '2027-01-01', 6),
            ('101027', '0341', 45, '2026-01-18', 6),
            ('101028', '0343', 80, '2027-01-01', 6),
            ('101001', '0345', 150, '2026-06-30', 6),
            ('101002', '0347', 200, '2026-08-01', 6),
            ('101003', '0349', 30, '2026-01-15', 6),
            ('101004', '0351', 100, '2026-01-25', 6),
            ('101005', '0353', 50, '2026-01-20', 6),
            ('101006', '0355', 120, '2026-10-30', 6),
            ('101007', '0357', 80, '2026-06-30', 6),
            ('101008', '0359', 60, None, 6),
            ('101009', '0361', 180, '2026-09-01', 6),
            
            # Row 04
            ('101010', '0401', 110, '2026-10-30', 6),
            ('101011', '0403', 25, '2026-02-10', 6),
            ('101012', '0405', 75, '2026-02-15', 6),
            ('101013', '0407', 40, '2026-06-30', 6),
            ('101014', '0409', 250, '2027-01-01', 6),
            ('101015', '0411', 30, '2028-01-01', 6),
            ('101016', '0413', 150, '2027-06-30', 6),
            ('101017', '0415', 80, None, 6),
            ('101018', '0417', 40, '2026-01-20', 6),
            ('101019', '0419', 50, '2026-03-01', 6),
            ('101020', '0421', 100, '2027-06-30', 6),
            ('101021', '0423', 90, '2028-01-01', 6),
            ('101022', '0425', 70, '2026-10-30', 6),
            ('101023', '0427', 100, '2026-06-30', 6),
            ('101024', '0429', 80, '2027-01-01', 6),
            ('101025', '0431', 250, '2026-08-01', 6),
            ('101026', '0433', 90, '2027-01-01', 6),
            ('101027', '0435', 45, '2026-01-18', 6),
            ('101028', '0437', 80, '2027-01-01', 6),
            ('101001', '0439', 150, '2026-06-30', 6),
            ('101002', '0441', 200, '2026-08-01', 6),
            ('101003', '0443', 30, '2026-01-15', 6),
            ('101004', '0445', 100, '2026-01-25', 6),
            ('101005', '0447', 50, '2026-01-20', 6),
            ('101006', '0449', 120, '2026-10-30', 6),
            ('101007', '0451', 80, '2026-06-30', 6),
            ('101008', '0453', 60, None, 6),
            ('101009', '0455', 180, '2026-09-01', 6),
            ('101010', '0457', 110, '2026-10-30', 6),
            ('101011', '0459', 25, '2026-02-10', 6),
            ('101012', '0461', 75, '2026-02-15', 6)],
            
            
            [# 102 - Currys
             
            # Row 05
            ('102001', '0501', 2, None, 6),
            ('102002', '0503', 3, None, 6),
            ('102003', '0505', 3, None, 6),
            ('102004', '0507', 1, None, 6),
            ('102005', '0509', 10, None, 6),
            ('102006', '0511', 50, None, 6),
            ('102007', '0513', 20, None, 6),
            ('102008', '0515', 10, None, 6),
            ('102009', '0517', 35, None, 6),
            ('102010', '0519', 5, None, 6),
            ('102011', '0521', 40, None, 6),
            ('102012', '0523', 5, None, 6),
            ('102013', '0525', 30, None, 6),
            ('102001', '0527', 2, None, 6),
            ('102002', '0529', 3, None, 6),
            ('102003', '0531', 3, None, 6),
            ('102004', '0533', 1, None, 6),
            ('102005', '0535', 10, None, 6),
            ('102006', '0537', 50, None, 6),
            ('102007', '0539', 20, None, 6),
            ('102008', '0541', 10, None, 6),
            ('102009', '0543', 35, None, 6),
            ('102010', '0545', 5, None, 6),
            ('102011', '0547', 40, None, 6),
            ('102012', '0549', 5, None, 6),
            ('102013', '0551', 30, None, 6),
            ('102001', '0553', 2, None, 6),
            ('102002', '0555', 3, None, 6),
            ('102003', '0557', 3, None, 6),
            ('102004', '0559', 1, None, 6),
            ('102005', '0561', 10, None, 6),

            # Row 07 (0701 -> 0751)
            ('102006', '0701', 50, None, 6),
            ('102007', '0703', 20, None, 6),
            ('102008', '0705', 10, None, 6),
            ('102009', '0707', 35, None, 6),
            ('102010', '0709', 5, None, 6),
            ('102011', '0711', 40, None, 6),
            ('102012', '0713', 5, None, 6),
            ('102013', '0715', 30, None, 6),
            ('102001', '0717', 2, None, 6),
            ('102002', '0719', 3, None, 6),
            ('102003', '0721', 3, None, 6),
            ('102004', '0723', 1, None, 6),
            ('102005', '0725', 10, None, 6),
            ('102006', '0727', 50, None, 6),
            ('102007', '0729', 20, None, 6),
            ('102008', '0731', 10, None, 6),
            ('102009', '0733', 35, None, 6),
            ('102010', '0735', 5, None, 6),
            ('102011', '0737', 40, None, 6),
            ('102012', '0739', 5, None, 6),
            ('102013', '0741', 30, None, 6),
            ('102001', '0743', 2, None, 6),
            ('102002', '0745', 3, None, 6),
            ('102003', '0747', 3, None, 6),
            ('102004', '0749', 1, None, 6),
            ('102005', '0751', 10, None, 6)],
            
            
            [# 103 - Lidl
            
            # Row 07 (0753 -> 0761)
            ('103001', '0753', 60, '2026-01-12', 6),
            ('103002', '0755', 2, '2026-03-01', 6),
            ('103003', '0757', 70, '2027-06-30', 6),
            ('103004', '0759', 50, '2030-01-01', 6),
            ('103005', '0761', 30, '2026-01-12', 6),
            
            # Row 08
            ('103006', '0801', 90, '2026-08-01', 6),
            ('103007', '0803', 50, '2026-01-15', 6),
            ('103008', '0805', 70, '2026-01-20', 6),
            ('103009', '0807', 40, '2026-10-30', 6),
            ('103010', '0809', 60, '2026-12-31', 6),
            ('103011', '0811', 35, '2026-06-30', 6),
            ('103012', '0813', 45, '2026-01-17', 6),
            ('103013', '0815', 50, '2030-01-01', 6),
            ('103014', '0817', 60, '2026-02-01', 6),
            ('103001', '0819', 60, '2026-01-12', 6),
            ('103002', '0821', 2, '2026-03-01', 6),
            ('103003', '0823', 70, '2027-06-30', 6),
            ('103004', '0825', 50, '2030-01-01', 6),
            ('103005', '0827', 30, '2026-01-12', 6),
            ('103006', '0829', 90, '2026-08-01', 6),
            ('103007', '0831', 50, '2026-01-15', 6),
            ('103008', '0833', 70, '2026-01-20', 6),
            ('103009', '0835', 40, '2026-10-30', 6),
            ('103010', '0837', 60, '2026-12-31', 6),
            ('103011', '0839', 35, '2026-06-30', 6),
            ('103012', '0841', 45, '2026-01-17', 6),
            ('103013', '0843', 50, '2030-01-01', 6),
            ('103014', '0845', 60, '2026-02-01', 6),
            ('103001', '0847', 60, '2026-01-12', 6),
            ('103002', '0849', 2, '2026-03-01', 6),
            ('103003', '0851', 70, '2027-06-30', 6),
            ('103004', '0853', 50, '2030-01-01', 6),
            ('103005', '0855', 30, '2026-01-12', 6),
            ('103006', '0857', 90, '2026-08-01', 6),
            ('103007', '0859', 50, '2026-01-15', 6),
            ('103008', '0861', 70, '2026-01-20', 6),
            
            # Row 09 (0901 -> 0951)
            ('103009', '0901', 40, '2026-10-30', 6),
            ('103010', '0903', 60, '2026-12-31', 6),
            ('103011', '0905', 35, '2026-06-30', 6),
            ('103012', '0907', 45, '2026-01-17', 6),
            ('103013', '0909', 50, '2030-01-01', 6),
            ('103014', '0911', 60, '2026-02-01', 6),
            ('103001', '0913', 60, '2026-01-12', 6),
            ('103002', '0915', 2, '2026-03-01', 6),
            ('103003', '0917', 70, '2027-06-30', 6),
            ('103004', '0919', 50, '2030-01-01', 6),
            ('103005', '0921', 30, '2026-01-12', 6),
            ('103006', '0923', 90, '2026-08-01', 6),
            ('103007', '0925', 50, '2026-01-15', 6),
            ('103008', '0927', 70, '2026-01-20', 6),
            ('103009', '0929', 40, '2026-10-30', 6),
            ('103010', '0931', 60, '2026-12-31', 6),
            ('103011', '0933', 35, '2026-06-30', 6),
            ('103012', '0935', 45, '2026-01-17', 6),
            ('103013', '0937', 50, '2030-01-01', 6),
            ('103014', '0939', 60, '2026-02-01', 6),
            ('103001', '0941', 60, '2026-01-12', 6),
            ('103002', '0943', 2, '2026-03-01', 6),
            ('103003', '0945', 70, '2027-06-30', 6),
            ('103004', '0947', 50, '2030-01-01', 6),
            ('103005', '0949', 30, '2026-01-12', 6),
            ('103006', '0951', 90, '2026-08-01', 6)],
            
            
            [# 104 - Ikea
            
            # Row 09 (0953 -> 0961)
            ('104001', '0953', 25, None, 6),
            ('104002', '0955', 300, None, 6),
            ('104003', '0957', 15, None, 6),
            ('104004', '0959', 10, None, 6),
            ('104005', '0961', 5, None, 6),

            # Row 10
            ('104006', '1001', 40, None, 6),
            ('104007', '1003', 8, None, 6),
            ('104008', '1005', 20, None, 6),
            ('104009', '1007', 40, None, 6),
            ('104010', '1009', 15, None, 6),
            ('104011', '1011', 50, None, 6),
            ('104012', '1013', 20, None, 6),
            ('104013', '1015', 30, None, 6),
            ('104014', '1017', 10, None, 6),
            ('104015', '1019', 12, None, 6),
            ('104001', '1021', 25, None, 6),
            ('104002', '1023', 300, None, 6),
            ('104003', '1025', 15, None, 6),
            ('104004', '1027', 10, None, 6),
            ('104005', '1029', 5, None, 6),
            ('104006', '1031', 40, None, 6),
            ('104007', '1033', 8, None, 6),
            ('104008', '1035', 20, None, 6),
            ('104009', '1037', 40, None, 6),
            ('104010', '1039', 15, None, 6),
            ('104011', '1041', 50, None, 6),
            ('104012', '1043', 20, None, 6),
            ('104013', '1045', 30, None, 6),
            ('104014', '1047', 10, None, 6),
            ('104015', '1049', 12, None, 6),
            ('104001', '1051', 25, None, 6),
            ('104002', '1053', 300, None, 6),
            ('104003', '1055', 15, None, 6),
            ('104004', '1057', 10, None, 6),
            ('104005', '1059', 5, None, 6),
            ('104006', '1061', 40, None, 6),

            # Row 11
            ('104007', '1101', 8, None, 6),
            ('104008', '1103', 20, None, 6),
            ('104009', '1105', 40, None, 6),
            ('104010', '1107', 15, None, 6),
            ('104011', '1109', 50, None, 6),
            ('104012', '1111', 20, None, 6),
            ('104013', '1113', 30, None, 6),
            ('104014', '1115', 10, None, 6),
            ('104015', '1117', 12, None, 6),
            ('104001', '1119', 25, None, 6),
            ('104002', '1121', 300, None, 6),
            ('104003', '1123', 15, None, 6),
            ('104004', '1125', 10, None, 6),
            ('104005', '1127', 5, None, 6),
            ('104006', '1129', 40, None, 6),
            ('104007', '1131', 8, None, 6),
            ('104008', '1133', 20, None, 6),
            ('104009', '1135', 40, None, 6),
            ('104010', '1137', 15, None, 6),
            ('104011', '1139', 50, None, 6),
            ('104012', '1141', 20, None, 6),
            ('104013', '1143', 30, None, 6),
            ('104014', '1145', 10, None, 6),
            ('104015', '1147', 12, None, 6),
            ('104001', '1149', 25, None, 6),
            ('104002', '1151', 300, None, 6),
            ('104003', '1153', 15, None, 6),
            ('104004', '1155', 10, None, 6),
            ('104005', '1157', 5, None, 6),
            ('104006', '1159', 40, None, 6),
            ('104007', '1161', 8, None, 6)]
            ]
    for i in stock:
        cursor.executemany('INSERT OR IGNORE INTO stock (productID, location, quantity, expiry, warehouseID) VALUES (?, ?, ?, ?, ?);', i)
    
    conn.commit()

def init_database():
    """
    Initialize the database with example data.
    """
    init_suppliers()
    init_products()
    init_stock()

#util function

def view_tables(table):
    cursor.execute(f"SELECT * FROM {table};")
    rows = cursor.fetchall()
    print(f"{table.capitalize()} Table:")
    print(tabulate(rows, headers=[desc[0] for desc in cursor.description], tablefmt="grid"))